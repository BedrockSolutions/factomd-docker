defaultValues:
  - ./confz.d/defaults.js
values:
  - ./values
valuesSchema:
  additionalProperties: false
  definitions:
    base64Id:
      type: string
      pattern: '^[0-9a-f]{64}$'
    pemData:
      type: string
      pattern: '^-{5}BEGIN [A-Z]([A-Z ]*[A-Z])?-{5}[\n\r]{1,2}(([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?[\n\r]{1,2})+-{5}END [A-Z]([A-Z ]*[A-Z])?-{5}$'
    tcpPort:
      type: integer
      minimum: 1025
      maximum: 65535
  dependencies:
    apiPassword:
      - apiUser
    apiUser:
      - apiPassword
    localServerPrivateKey:
      - identityChainId
      - localServerPublicKey
    localServerPublicKey:
      - identityChainId
      - localServerPrivateKey
    tlsPrivateKey:
      - tlsPublicCert
    tlsPublicCert:
      - tlsPrivateKey
  allOf:
    - if:
        properties:
          tlsEnabled:
            const: true
      then:
        dependencies:
          tlsEnabled:
            - tlsPrivateKey
            - tlsPublicCert
  properties:
    apiPassword:
      type: string
    apiPort:
      $ref: '#/definitions/tcpPort'
    apiUser:
      type: string
    bootstrapIdentity:
      $ref: '#/definitions/base64Id'
    bootstrapKey:
      $ref: '#/definitions/base64Id'
    broadcastNum:
      type: integer
      minimum: 1
    changeAcksHeight:
      type: integer
      minimum: 0
    controlPanelSetting:
      type: string
      enum:
        - disabled
        - readonly
        - readwrite
    controlPanelPort:
      $ref: '#/definitions/tcpPort'
    corsDomains:
      type: array
      oneOf:
        - items:
            type: string
            const: '*'
          minItems: 1
          maxItems: 1
        - items:
            type: string
            format: hostname
          minItems: 1
          uniqueItems: true
    customNet:
      type: string
    directoryBlockInSeconds:
      type: integer
      minimum: 0
    exchangeRateAuthorityPublicKey:
      $ref: '#/definitions/base64Id'
    exclusive:
      type: boolean
    exclusiveIn:
      type: boolean
    fastBoot:
      type: boolean
    faultTimeout:
      type: integer
      minimum: 0
    identityChainId:
      $ref: '#/definitions/base64Id'
    localServerPrivateKey:
      $ref: '#/definitions/base64Id'
    localServerPublicKey:
      $ref: '#/definitions/base64Id'
    network:
      type: string
      enum:
        - CUSTOM
        - LOCAL
        - MAIN
        - TEST
    networkPort:
      $ref: '#/definitions/tcpPort'
    networkProfile:
      type: string
      enum:
        - mainnet
        - testnet
    nodeName:
      type: string
    roleProfile:
      type: string
      enum:
        - authority
        - follower
    seedUrl:
      type: string
      format: uri
    specialPeers:
      type: array
      items:
        type: string
        format: uri-reference
      minItems: 1
      uniqueItems: true
    startDelay:
      type: integer
      minimum: 0
    tlsEnabled:
      type: boolean
    tlsPrivateKey:
      $ref: '#/definitions/pemData'
    tlsPublicCert:
      $ref: '#/definitions/pemData'
  type: object
